<!DOCTYPE html>
<html>
  <body>

    <div class="site">

		<header class="header"></header>

		<main class="main">
			
			<sidebar class="sidebar"></sidebar>

			<div class="content">
				
				<div class="content__player">

					<a href="#" class="content__navigation js-navigation">
						<span></span>
						<span></span>
						<span></span>
					</a>
	
					<div class="content__overlay">

						<include src="./parts/navigation.html"></include>

					</div>

					<div id="player" class="player"></div>

				</div>

				<div class="content__controls">

					<bottom class="bottom">
			
						<div class="bottom__current js-current"></div>

						<div class="bottom__main-controls">
			
							<div class="bottom__controls">
			
								<a href="#" class="bottom__control-item bottom__control-item--shuffle js-shuffle"></a>

								<a href="#" class="bottom__control-item bottom__control-item--previous js-previous"></a>
								
								<a href="#" class="bottom__control-item bottom__control-item--play js-play"></a>
								
								<a href="#" class="bottom__control-item bottom__control-item--next js-next"></a>
								
								<a href="#" class="bottom__control-item bottom__control-item--repeat js-repeat"></a>
			
							</div>
			
							
							<div class="bottom__progress"></div>
							
						</div>

						<div class="bottom__duration js-duration"></div>
						
						<div class="bottom__volume">

							<div class="volume"></div>

						</div>
			
					</bottom>

				</div>

			</div>

		</main>

    </div>

    <script>
		// 2. This code loads the IFrame Player API code asynchronously.
		var tag = document.createElement('script');

		tag.src = "https://www.youtube.com/iframe_api";
		var firstScriptTag = document.getElementsByTagName('script')[0];
		firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
		
		// Player
		var player;
		var playlistId = 'PLwE3TEHTVMsJjsMzY0Kxgfoj8ejeMfalT';

		function onYouTubeIframeAPIReady() {
			player = new YT.Player('player', {
				height: '427',
				width: '700',
				playerVars: { 'controls': 0, 'autoplay': 1, 'listType': 'playlist', 'list': playlistId },
				events: {
				'onReady': onPlayerReady,
				'onStateChange': onPlayerStateChange
				}
			});
		}

		// 4. The API will call this function when the video player is ready.
		function onPlayerReady(event) {
			event.target.playVideo();
			event.target.setVolume(50);

			// Current time
			const current = document.querySelector('.js-current');
			const currentTime = player.getCurrentTime();

			current.innerHTML = `
				<span>${currentTime}</span>
			`;

		}
		
		// Get duration
		const duration = document.querySelector('.js-duration');

		setInterval(function() {
			const durationSeconds = player.getDuration();

			console.log(durationSeconds)
		}, 1000);

		// 5. The API calls this function when the player's state changes.
		//    The function indicates that when playing a video (state=1),
		//    the player should play for six seconds and then stop.
		var done = false;
		function onPlayerStateChange(event) {}

		var stopButton = document.querySelector('.js-play');
		var nextButton = document.querySelector('.js-next');
		var previousButton = document.querySelector('.js-previous');
		var navigationButton = document.querySelector('.js-navigation');
		var repeatButton = document.querySelector('.js-repeat');

		stopButton.addEventListener('click', function(e) {
			e.preventDefault();
			stopButton.classList.toggle('is-paused');
			
			if(stopButton.classList.contains('is-paused')) {
				player.playVideo();
			} else {
				player.pauseVideo();
			}
		})

		// Next Video
		nextButton.addEventListener('click', function(e) {
			e.preventDefault();
			player.nextVideo();
		})
		
		// Previous Video
		previousButton.addEventListener('click', function(e) {
			e.preventDefault();
			player.previousVideo();
		})
		
		// Previous Video
		repeatButton.addEventListener('click', function(e) {
			e.preventDefault();
			player.setLoop();
		})

		// Navigation Button
		navigationButton.addEventListener('click', function(e) {
			e.preventDefault();
			document.body.classList.toggle('is-visible');
		})

		const navigationList = document.querySelector('.navigation__items');
		const navigationLinks = navigationList.querySelectorAll('.navigation__link');

		for (let index = 0; index < navigationLinks.length; index++) {
			const link = navigationLinks[index];

			link.addEventListener('click', function(e) {
				e.preventDefault();

				const playlistLink = link.getAttribute('href');
				playlistId = playlistLink;
			})
			
		}
	  
    </script>

    <script src="main.js"></script>
    
  </body>
</html>